version: 1.0
runtime: nodejs22

build:
  commands:
    pre-build:
      - bash -lc "./scripts/prebuild.sh"
    build:
      - pnpm install --frozen-lockfile

run:
  pre-run:
    - bash -lc "./scripts/prerun.sh"
  command: bash -lc "./scripts/run.sh"

  network:
    port: 8080
  secrets:
    - name: INFURA_API_KEY
      value-from: "arn:aws:secretsmanager:us-east-1:741448937731:secret:prod/REVNET_INFURA_API_KEY-xxxxxxxx"
    - name: DATABASE_URL
      value-from: "arn:aws:secretsmanager:us-east-1:741448937731:secret:prod/REVNET_DB_URL-xxxxxxxx"
    - name: REDIS_URL
      value-from: "arn:aws:secretsmanager:us-east-1:741448937731:secret:prod/REVNET_REDIS_URL-xxxxxxxx"
    - name: WHISK_API_KEY
      value-from: "arn:aws:secretsmanager:us-east-1:741448937731:secret:prod/REVNET_WHISK_API_KEY-xxxxxxxx"
    - name: PINATA_JWT
      value-from: "arn:aws:secretsmanager:us-east-1:741448937731:secret:prod/REVNET_PINATA_JWT-xxxxxxxx"
